<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  <title>Django Static Image Loading | Ian He&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <link rel="shortcut icon" href="/avator.png">
  <link rel="stylesheet" href="/css/app.css">
  <!-- <link rel='stylesheet' href='http://fonts.useso.com/css?family=Source+Code+Pro'> -->
</head>
</html>
<body>
  <nav class="app-nav">
  
    
        <a href="/."><button>home</button></a>
      
    
    
        <a href="/archives"><button>archive</button></a>
      
    
    
        <a href="/tags"><button>tags</button></a>
      
    
    
        <a href="/about"><button>about</button></a>
      
    
</nav>
<script src="/js/button.js"></script>

  <main class="post">
  <article>
  <h1 class="article-title">
    <a href="/2016/10/20/Django-Static-Image-Loading/">Django Static Image Loading</a>
  </h1>

  <section class="article-meta">
    <p class="article-date">十月 20 2016</p>
  </section>
  
  <section class="article-entry">
    <h2 id="如何在Django模版中显示ImageField上传的图片"><a href="#如何在Django模版中显示ImageField上传的图片" class="headerlink" title="如何在Django模版中显示ImageField上传的图片"></a>如何在Django模版中显示ImageField上传的图片</h2><p><strong><em> 需要知道的内容： </em></strong></p>
<p>ImageField再上传图片时，会将图片放置在upload_to路径的文件夹内，路径的根目录则是工程根目录。</p>
<p>图片不能直接通过 src＝”/相对路径/“ 引用，需要将文件夹映射到绝对路径上，比如加载静态文件的时候，可以利用 django.contrib.staticfiles ，设置 STATIC_URL＝’/static’ ，然后将静态文件放置于 app/static 内，然后通过load static 加载。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># models.py</span><br><span class="line"># app名为Gallery</span><br><span class="line">class Photo(models.Model):</span><br><span class="line">    title = models.CharField(max_length = 150)</span><br><span class="line">    photo = models.ImageField(upload_to=&apos;Gallery/static/photo&apos;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># views.py</span><br><span class="line">def detail(request, design_id):</span><br><span class="line">    try:</span><br><span class="line">        design = Gallery.object.get(pk = design_id)</span><br><span class="line">        photo_url = &apos;designs/&apos; + design.photo.name.split(&apos;/&apos;)[-1]</span><br><span class="line">        # 前半部分是图片路径，根据自己的设置自己配制就行了； </span><br><span class="line">        # 后半部分是提取ImageField中图片的文件名</span><br><span class="line">        # 稍后再模版部分会解释为什么需要自己写路径</span><br><span class="line">        template = loader.get_template(&apos;gallery/detail.html&apos;)  # 模版路径</span><br><span class="line">        context = &#123;</span><br><span class="line">            &apos;design&apos;: design,</span><br><span class="line">            &apos;photo_url&apos;: photo_url,</span><br><span class="line">            &#125;</span><br><span class="line">    except Gallery.DoesNotExist:</span><br><span class="line">        raise Http404(&apos;Not Found&apos;)</span><br><span class="line">    return HttpResponse(template.render(context, request))</span><br></pre></td></tr></table></figure>
<p>在上面的模版文件中加载静态文件分为两个步骤：</p>
<p>1、声明要加载静态文件 load static 。<br>2、加载需要加载的静态文件。第一个变量目的是声明路径为静态文件路径，然后第二个变量就是该文件的相对于 /static/ 的路径。</p>
<p><strong><em> django的template语法和Hexo的ejs模版发生冲突了，如果表达不清楚，那我也没办法，只好将就着看了 &gt;.&lt; </em></strong></p>

  </section>
</article>

</main>

</body>
</html>
